!function(e){function t(a){if(n[a])return n[a].exports;var o=n[a]={exports:{},id:a,loaded:!1};return e[a].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="/outloud/",t(0)}([function(e,t,n){"use strict";n(66)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}n(67);var o=n(81),i=a(o),s=n(82),r=a(s),u=n(83),l=a(u),c=n(126),d=a(c),g=!1;angular.module("app",["vendor",l["default"].name]).constant("__DEBUG__",g).config(r["default"]).controller("RootCtrl",function(){var e=this;return e}).service("Helpers",d["default"]).directive("fileread",function(){"ngInject";var e=function(e){e.$apply(function(){e.fileread=""})};return{scope:{fileread:"="},link:function(t,n){n.bind("change",function(n){if(!(n&&n.target&&n.target.files&&n.target.files[0]))return e(t);var a=n.target.files[0],o=new FileReader;o.onload=function(e){t.$apply(function(){t.fileread=e.target.result})},o.onerror=function(e){console.warn("FileReader error:",e)},o.readAsDataURL(a)})}}}).directive("fileChange",["$parse",function(e){"ngInject";return{require:"ngModel",restrict:"A",link:function(t,n,a,o){var i=e(a.fileChange),s=function(e){t.$apply(function(){i(t,{$event:e,files:e.target.files,$scope:t})})};n[0].addEventListener("change",s,!1)}}}]).filter("unsafe",["$sce",function(e){"ngInject";return function(t){return e.trustAsHtml(t)}}]).directive("contenteditable",["$sce",function(e){"ngInject";return{require:"?ngModel",restrict:"A",link:function(t,n,a,o){function i(){var e=n.html();e=e.replace(/<div>/gi," ").replace(/[<\/div>|<br>]/gi,""),a.stripBr&&"<br>"===e&&(e=""),o.$setViewValue(e)}o&&(o.$render=function(){n.html(e.getTrustedHtml(o.$viewValue||""))},n.on("blur keyup change",function(){t.$evalAsync(i)}))}}}]).directive("elastic",["$timeout",function(e){"ngInject";return{restrict:"A",link:function(t,n){t.initialHeight=t.initialHeight||n[0].style.height,n[0].style.overflow="hidden";var a=function(){n[0].style.height=t.initialHeight,n[0].style.height=""+n[0].scrollHeight+"px"};n.on("input paste change",a),e(a,0)}}}]).directive("maxLength",["$compile",function(e){"ngInject";return{restrict:"A",require:"?ngModel",link:function(t,n,a){var o=a.maxLength,i=o+"-"+a.ngModel+".length";t.getColor=function(e){return e>0?"#999":"#E9595B"};var s='<div max-length-value ng-style="{color: getColor('+i+') }">{{ '+i+" }}</div>",r=e(s);n.after(r(t))}}}]).directive("willFocus",["$timeout",function(e){"ngInject";return{restrict:"A",link:function(t,n,a){var o=a.willFocus||200,i=n[0];e(function(){try{i.focus()}catch(e){console.warn("willFocus fails",e)}},o)}}}]).run(i["default"])},function(e,t){},,,,,,,,,,,,,,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["$rootScope","$http","Api",function(e,t,n){"ngInject";var a={$stateChangeStart:function(e,t,n,a,o){console.info("$stateChangeStart",e,t,n,a,o)},$stateChangeSuccess:function(e,t,n,a,o){console.info("$stateChangeSuccess",e,t,n,a,o)},$stateNotFound:function(e,t,n,a){console.warn("$stateNotFound",e,t,n,a)},$stateChangeError:function(e,t,n,a,o,i){console.error("$stateChangeError",e,t,n,a,o,i)}};for(var o in a)e.$on(o,a[o]);window.appDebug={$rootScope:e,$http:t,Api:n}}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["$locationProvider","$httpProvider",function(e,t){"ngInject";e.html5Mode({requireBase:!1,enabled:!0}),angular.merge(t.defaults,{headers:{post:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}}})}]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(84);n(85),n(86);var i=n(87),s=a(i),r=n(94),u=a(r),l=n(97),c=a(l),d=n(98),g=a(d),h=n(99),f=a(h),m=n(100),p=a(m),v=n(101),I=a(v),b=n(102),A=a(b),E=n(103),S=a(E),M=n(106),C=a(M),_=n(109),y=a(_),w=n(112),T=a(w),O=n(117),G=a(O),P=n(120),j=a(P),x=n(123),N=a(x),$=n(124),B=a($),D=n(125),U=a(D);t["default"]=angular.module("broadcastBuilder",[]).constant("ENTITY_TYPES",o.ENTITY_TYPES).constant("QUEUE_TYPES",o.QUEUE_TYPES).constant("MESSAGE_TYPES",o.MESSAGE_TYPES).constant("MESSAGE_ACTION_TYPES",o.MESSAGE_ACTION_TYPES).constant("MESSAGE_RESTRICTIONS",o.MESSAGE_RESTRICTIONS).constant("MESSAGE_QUEUE_SCHEMES",o.MESSAGE_QUEUE_SCHEMES).constant("MESSAGE_SCHEMES",o.MESSAGE_SCHEMES).constant("MESSAGE_BUTTON_SCHEME",o.MESSAGE_BUTTON_SCHEME).constant("MESSAGE_GALLERY_ITEM_SCHEME",o.MESSAGE_GALLERY_ITEM_SCHEME).constant("SCROLL_EVENT_NAME","builder-scroll").constant("API_URL",{BASE:window.API_URL||"http://outloud.pro",UPLOAD:window.UPLOAD_URL||"http://outloud.pro/upload"}).config(B["default"]).service("Api",s["default"]).service("BroadcastQueuesService",c["default"]).factory("BroadcastQueue",g["default"]).factory("Message",f["default"]).service("MessageActionButtonService",p["default"]).factory("MessageActionButton",I["default"]).factory("MessageImageItem",A["default"]).factory("SortableConfig",U["default"]).component("broadcastBuilder",y["default"]).component("broadcastBuilderBreadcrumbs",u["default"]).component("messageText",T["default"]).component("messageImage",G["default"]).component("messageGallery",j["default"]).component("messageButton",C["default"]).component("addButton",S["default"]).run(N["default"])},function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var a,o=(t.ENTITY_TYPES={QUEUE:0,MESSAGE:1,BUTTON:2,GALLERY_ITEM:3},t.QUEUE_TYPES={POST:0}),i=(t.MESSAGE_QUEUE_SCHEMES=n({},o.POST,{type:o.POST,title:"",isRoot:!1,messages:[]}),t.MESSAGE_TYPES={TEXT:"text",IMAGE:"image",GALLERY:"gallery"}),s=t.MESSAGE_ACTION_TYPES={SEND_MESSAGE:"message",GO_TO_URL:"url"};t.MESSAGE_GALLERY_ITEM_SCHEME={title:"",url:"",text:"",img:"",buttons:[]},t.MESSAGE_BUTTON_SCHEME={type:s.SEND_MESSAGE,title:"",url:"",messages:[]},t.MESSAGE_SCHEMES=(a={},n(a,i.TEXT,{type:i.TEXT,text:"",buttons:[]}),n(a,i.IMAGE,{type:i.IMAGE,img:""}),n(a,i.GALLERY,{type:i.GALLERY,items:[]}),a),t.MESSAGE_RESTRICTIONS={MAX_BUTTONS_COUNT:3,MAX_IMAGES_COUNT:10}},function(e,t){var n,a=window.angular;try{n=a.module(["ng"])}catch(o){n=a.module("ng",[])}var i='\n<div class="list-group">\n<button ng-repeat="type in $ctrl.values" ng-click="$ctrl.select(type);$ctrl.isOpen=!$ctrl.isOpen;" class="list-group-item">{{ type.title }}</button>\n</div>\n',s="tpl/common/templates/valueSelect.html",r=a.element(window.document).injector();r?r.get("$templateCache").put(s,i):n.run(["$templateCache",function(e){e.put(s,i)}]),e.exports=i},function(e,t){var n,a=window.angular;try{n=a.module(["ng"])}catch(o){n=a.module("ng",[])}var i='<form id="btn-settings" class="settings" ng-init="button=$ctrl.button || {type:0}">\n<div class="setting-btn">\n<div class="form-group">\n<div class="l-relative">\n<input ng-model="button.title" will-focus type="text" class="form-control" max-length="20" placeholder="New button">\n</div>\n</div>\n<ul class="nav nav-tabs nav-justified">\n<li role="presentation" ng-model="button.type" uib-btn-radio="$ctrl.MESSAGE_ACTION_TYPES.SEND_MESSAGE" class="active">\n<a href="#">Send Message</a>\n</li>\n<li role="presentation" ng-model="button.type" uib-btn-radio="$ctrl.MESSAGE_ACTION_TYPES.GO_TO_URL">\n<a href="#">Go to URL</a>\n</li>\n</ul>\n<div class="form-group" ng-switch="button.type">\n<div ng-if="button.type === $ctrl.MESSAGE_ACTION_TYPES.SEND_MESSAGE">\n<button type="button" ng-click="$ctrl.editMessages(button)" class="btn btn-default s-br-transparent">{{ !button.messages.length ? "+ Add message" : button.messages.length === 1 ? "Edit message" : "Edit messages" }}\n</button>\n</div>\n<div ng-if="button.type === $ctrl.MESSAGE_ACTION_TYPES.GO_TO_URL">\n<input ng-model="button.url" type="text" class="form-control" placeholder="url">\n</div>\n</div>\n<div class="clearfix">\n<button type="button" class="btn btn-default pull-left" ng-click="$ctrl.removeButton(button)">Remove\n</button>\n<button type="submit" class="btn btn-success pull-right" ng-click="$ctrl.saveButton(button)">Save\n</button>\n</div>\n</div>\n</form>\n',s="tpl/common/templates/actionButtonEdit.html",r=a.element(window.document).injector();r?r.get("$templateCache").put(s,i):n.run(["$templateCache",function(e){e.put(s,i)}]),e.exports=i},function(e,t,n){"use strict";var a=n(88),o=function(){function e(e,t,n){this.$http=e,this.$httpParamSerializerJQLike=t,this.API_URL=n}return e.$inject=["$http","$httpParamSerializerJQLike","API_URL"],e.prototype.upload=function(e){var t=new FormData;return t.append("file",e),this.$http.post(this.API_URL.UPLOAD,t,{withCredentials:!0,headers:{"Content-Type":void 0},transformRequest:angular.identity})},e.prototype.auth=function(e,t){return this.$http({method:"POST",url:a.resolve(this.API_URL.BASE,"/login"),headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({email:e,password:t})})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&l(e)&&e instanceof a)return e;var o=new a;return o.parse(e,t,n),o}function i(e){return u(e)&&(e=o(e)),e instanceof a?e.format():a.prototype.format.call(e)}function s(e,t){return o(e,!1,!0).resolve(t)}function r(e,t){return e?o(e,!1,!0).resolveObject(t):t}function u(e){return"string"==typeof e}function l(e){return"object"==typeof e&&null!==e}function c(e){return null===e}function d(e){return null==e}var g=n(89);t.parse=o,t.resolve=s,t.resolveObject=r,t.format=i,t.Url=a;var h=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","\t"],p=["{","}","|","\\","^","`"].concat(m),v=["'"].concat(p),I=["%","/","?",";","#"].concat(v),b=["/","?","#"],A=255,E=/^[a-z0-9A-Z_-]{0,63}$/,S=/^([a-z0-9A-Z_-]{0,63})(.*)$/,M={javascript:!0,"javascript:":!0},C={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(91);a.prototype.parse=function(e,t,n){if(!u(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e;a=a.trim();var o=h.exec(a);if(o){o=o[0];var i=o.toLowerCase();this.protocol=i,a=a.substr(o.length)}if(n||o||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===a.substr(0,2);!s||o&&C[o]||(a=a.substr(2),this.slashes=!0)}if(!C[o]&&(s||o&&!_[o])){for(var r=-1,l=0;l<b.length;l++){var c=a.indexOf(b[l]);c!==-1&&(r===-1||c<r)&&(r=c)}var d,f;f=r===-1?a.lastIndexOf("@"):a.lastIndexOf("@",r),f!==-1&&(d=a.slice(0,f),a=a.slice(f+1),this.auth=decodeURIComponent(d)),r=-1;for(var l=0;l<I.length;l++){var c=a.indexOf(I[l]);c!==-1&&(r===-1||c<r)&&(r=c)}r===-1&&(r=a.length),this.host=a.slice(0,r),a=a.slice(r),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var p=this.hostname.split(/\./),l=0,w=p.length;l<w;l++){var T=p[l];if(T&&!T.match(E)){for(var O="",G=0,P=T.length;G<P;G++)O+=T.charCodeAt(G)>127?"x":T[G];if(!O.match(E)){var j=p.slice(0,l),x=p.slice(l+1),N=T.match(S);N&&(j.push(N[1]),x.unshift(N[2])),x.length&&(a="/"+x.join(".")+a),this.hostname=j.join(".");break}}}if(this.hostname.length>A?this.hostname="":this.hostname=this.hostname.toLowerCase(),!m){for(var $=this.hostname.split("."),B=[],l=0;l<$.length;++l){var D=$[l];B.push(D.match(/[^A-Za-z0-9_-]/)?"xn--"+g.encode(D):D)}this.hostname=B.join(".")}var U=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+U,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!M[i])for(var l=0,w=v.length;l<w;l++){var R=v[l],k=encodeURIComponent(R);k===R&&(k=escape(R)),a=a.split(R).join(k)}var Y=a.indexOf("#");Y!==-1&&(this.hash=a.substr(Y),a=a.slice(0,Y));var Z=a.indexOf("?");if(Z!==-1?(this.search=a.substr(Z),this.query=a.substr(Z+1),t&&(this.query=y.parse(this.query)),a=a.slice(0,Z)):t&&(this.search="",this.query={}),a&&(this.pathname=a),_[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",D=this.search||"";this.path=U+D}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",a=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&l(this.query)&&Object.keys(this.query).length&&(i=y.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||_[t])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),a&&"#"!==a.charAt(0)&&(a="#"+a),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+o+n+s+a},a.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(u(e)){var t=new a;t.parse(e,!1,!0),e=t}var n=new a;if(Object.keys(this).forEach(function(e){n[e]=this[e]},this),n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(n[t]=e[t])}),_[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!_[e.protocol])return Object.keys(e).forEach(function(t){n[t]=e[t]}),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||C[e.protocol])n.pathname=e.pathname;else{for(var o=(e.pathname||"").split("/");o.length&&!(e.host=o.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),n.pathname=o.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var i=n.pathname||"",s=n.search||"";n.path=i+s}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var r=n.pathname&&"/"===n.pathname.charAt(0),l=e.host||e.pathname&&"/"===e.pathname.charAt(0),g=l||r||n.host&&e.pathname,h=g,f=n.pathname&&n.pathname.split("/")||[],o=e.pathname&&e.pathname.split("/")||[],m=n.protocol&&!_[n.protocol];if(m&&(n.hostname="",n.port=null,n.host&&(""===f[0]?f[0]=n.host:f.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===o[0]?o[0]=e.host:o.unshift(e.host)),e.host=null),g=g&&(""===o[0]||""===f[0])),l)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,f=o;else if(o.length)f||(f=[]),f.pop(),f=f.concat(o),n.search=e.search,n.query=e.query;else if(!d(e.search)){if(m){n.hostname=n.host=f.shift();var p=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");p&&(n.auth=p.shift(),n.host=n.hostname=p.shift())}return n.search=e.search,n.query=e.query,c(n.pathname)&&c(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!f.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var v=f.slice(-1)[0],I=(n.host||e.host)&&("."===v||".."===v)||""===v,b=0,A=f.length;A>=0;A--)v=f[A],"."==v?f.splice(A,1):".."===v?(f.splice(A,1),b++):b&&(f.splice(A,1),b--);if(!g&&!h)for(;b--;b)f.unshift("..");!g||""===f[0]||f[0]&&"/"===f[0].charAt(0)||f.unshift(""),I&&"/"!==f.join("/").substr(-1)&&f.push("");var E=""===f[0]||f[0]&&"/"===f[0].charAt(0);if(m){n.hostname=n.host=E?"":f.length?f.shift():"";var p=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");p&&(n.auth=p.shift(),n.host=n.hostname=p.shift())}return g=g||n.host&&f.length,g&&!E&&f.unshift(""),f.length?n.pathname=f.join("/"):(n.pathname=null,n.path=null),c(n.pathname)&&c(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},a.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){var a;(function(e,o){!function(i){function s(e){throw RangeError(j[e])}function r(e,t){for(var n=e.length,a=[];n--;)a[n]=t(e[n]);return a}function u(e,t){var n=e.split("@"),a="";n.length>1&&(a=n[0]+"@",e=n[1]),e=e.replace(P,".");var o=e.split("."),i=r(o,t).join(".");return a+i}function l(e){for(var t,n,a=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(n=e.charCodeAt(o++),56320==(64512&n)?a.push(((1023&t)<<10)+(1023&n)+65536):(a.push(t),o--)):a.push(t);return a}function c(e){return r(e,function(e){var t="";return e>65535&&(e-=65536,t+=$(e>>>10&1023|55296),e=56320|1023&e),t+=$(e)}).join("")}function d(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:E}function g(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function h(e,t,n){var a=0;for(e=n?N(e/_):e>>1,e+=N(e/t);e>x*M>>1;a+=E)e=N(e/x);return N(a+(x+1)*e/(e+C))}function f(e){var t,n,a,o,i,r,u,l,g,f,m=[],p=e.length,v=0,I=w,b=y;for(n=e.lastIndexOf(T),n<0&&(n=0),a=0;a<n;++a)e.charCodeAt(a)>=128&&s("not-basic"),m.push(e.charCodeAt(a));for(o=n>0?n+1:0;o<p;){for(i=v,r=1,u=E;o>=p&&s("invalid-input"),l=d(e.charCodeAt(o++)),(l>=E||l>N((A-v)/r))&&s("overflow"),v+=l*r,g=u<=b?S:u>=b+M?M:u-b,!(l<g);u+=E)f=E-g,r>N(A/f)&&s("overflow"),r*=f;t=m.length+1,b=h(v-i,t,0==i),N(v/t)>A-I&&s("overflow"),I+=N(v/t),v%=t,m.splice(v++,0,I)}return c(m)}function m(e){var t,n,a,o,i,r,u,c,d,f,m,p,v,I,b,C=[];for(e=l(e),p=e.length,t=w,n=0,i=y,r=0;r<p;++r)m=e[r],m<128&&C.push($(m));for(a=o=C.length,o&&C.push(T);a<p;){for(u=A,r=0;r<p;++r)m=e[r],m>=t&&m<u&&(u=m);for(v=a+1,u-t>N((A-n)/v)&&s("overflow"),n+=(u-t)*v,t=u,r=0;r<p;++r)if(m=e[r],m<t&&++n>A&&s("overflow"),m==t){for(c=n,d=E;f=d<=i?S:d>=i+M?M:d-i,!(c<f);d+=E)b=c-f,I=E-f,C.push($(g(f+b%I,0))),c=N(b/I);C.push($(g(c,0))),i=h(n,v,a==o),n=0,++a}++n,++t}return C.join("")}function p(e){return u(e,function(e){return O.test(e)?f(e.slice(4).toLowerCase()):e})}function v(e){return u(e,function(e){return G.test(e)?"xn--"+m(e):e})}var I=("object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof o&&o);I.global!==I&&I.window!==I&&I.self!==I||(i=I);var b,A=2147483647,E=36,S=1,M=26,C=38,_=700,y=72,w=128,T="-",O=/^xn--/,G=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,j={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=E-S,N=Math.floor,$=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:l,encode:c},decode:f,encode:m,toASCII:v,toUnicode:p},a=function(){return b}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}(this)}).call(t,n(90)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){"use strict";t.decode=t.parse=n(92),t.encode=t.stringify=n(93)},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,a,o){t=t||"&",a=a||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(t);var r=1e3;o&&"number"==typeof o.maxKeys&&(r=o.maxKeys);var u=e.length;r>0&&u>r&&(u=r);for(var l=0;l<u;++l){var c,d,g,h,f=e[l].replace(s,"%20"),m=f.indexOf(a);m>=0?(c=f.substr(0,m),d=f.substr(m+1)):(c=f,d=""),g=decodeURIComponent(c),h=decodeURIComponent(d),n(i,g)?Array.isArray(i[g])?i[g].push(h):i[g]=[i[g],h]:i[g]=h}return i}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,a,o){return t=t||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var i=encodeURIComponent(n(o))+a;return Array.isArray(e[o])?e[o].map(function(e){return i+encodeURIComponent(n(e))}).join(t):i+encodeURIComponent(n(e[o]))}).join(t):o?encodeURIComponent(n(o))+a+encodeURIComponent(n(e)):""}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(95),i=a(o),s=n(96),r=a(s);t["default"]={template:i["default"],controller:r["default"],bindings:{model:"<"}}},function(e,t){var n,a=window.angular;try{n=a.module(["ng"])}catch(o){n=a.module("ng",[])}var i='<ol class="breadcrumb" ng-init="rootName = \'Post\'">\n<li ng-repeat="point in $ctrl.path" ng-class="{\'active\': $ctrl.isActiveState(point) }" class="breadcrumb-item">\n<a ng-if="$first && !$last" ui-sref="broadcast.child({id:point.self._meta.id})" ui-sref-opts="{location:false}">{{:: rootName }}</a>\n<a ng-if="$middle" ui-sref="broadcast.child({id:point.self._meta.id})" ui-sref-opts="{location:false}">{{ point.parent.title }}</a>\n<span ng-if="$last">{{ $first? rootName : point.parent.title }}</span>\n</li>\n</ol>\n',s="tpl/BroadcastBuilder/breadcrumbs/breadcrumbs.tpl.html",r=a.element(window.document).injector();r?r.get("$templateCache").put(s,i):n.run(["$templateCache",function(e){e.put(s,i)}]),e.exports=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=window._,i=function(){function e(t,a,o,i,s,r,u){"ngInject";n(this,e),this.$q=a,this.collection=this.model,this.ENTITY_TYPES=s,this.path=[],this.$scope=o,this.$state=i,this.BroadcastQueuesService=r,this.MessageActionButtonService=u}return e.$inject=["_","$q","$scope","$state","ENTITY_TYPES","BroadcastQueuesService","MessageActionButtonService"],a(e,[{key:"$onInit",value:function(){console.log("ready"),this.setPath(),this.$scope.$on("$stateChangeSuccess",this.setPath.bind(this))}},{key:"setPath",value:function(){var e=this;this.getCurrentPath(this.collection,o.get(this,"$state.params.id")).then(function(t){e.path=t})}},{key:"isActiveState",value:function t(e){if(this.collection.length<2&&!this.$state.params.id)return!0;var t=this.$state.includes("broadcast.child",{id:o.get(e,"self._meta.id")});return t}},{key:"getCurrentPath",value:function(e,t){var n=this,a=this.$q.defer(),i=[],s="unshift";return!t||e.length<2?(this.BroadcastQueuesService.getRoot().then(function(e){a.resolve([{self:e}])}),a.promise):(this.getPoint("current",t).then(function(e){i[s](e);var t=o.get(e,"self._meta.parentId");n.promiseWhile(function(){return!!t},function(){return n.getPoint("parent",t).then(function(e){i[s](e),t=o.get(e,"self._meta.parentId")})}).then(function(){a.resolve(i)})["catch"](function(e){console.warn("async while catch",e)})}),a.promise)}},{key:"getPoint",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"current",n=arguments[1];if(!n)return this.$q.reject("no pointId");var a=void 0,i=void 0,s={self:null,parent:null};return a=this.$q.defer(),i=function(){switch(t){case"current":return"getById";case"parent":return"getByInnerButtonId"}}(),this.BroadcastQueuesService[i](n).then(function(t){s.self=t;var n=o.get(t,"_meta.parentId");return n?e.MessageActionButtonService.getById(n):e.$q.resolve(null)}).then(function(e){s.parent=e,a.resolve(s)}),a.promise}},{key:"promiseWhile",value:function(e,t){var n=this,a=this.$q.defer(),o=function i(){return e()?void n.$q.when(t(),i,a.reject):a.resolve()};return setTimeout(o),a.promise}}]),e}();t["default"]=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","$q","BroadcastQueue","Helpers",function(e,t,n,a){"ngInject";var o=[];return{getAll:function(){return t.resolve(o)},getRoot:function(){return t.resolve(e.find(o,{isRoot:!0}))},getById:function(n){return n+="",t.resolve(e.find(o,{_meta:{id:n}}))},getByInnerButtonId:function(n){var a=function(t){return e.find(t,function(t){return e.get(t,"_meta.id")===n})};return t.resolve(e.find(o,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.find(t.messages,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.get(t,"items.length")?e.find(t.items,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(e.buttons)}):t.buttons?a(t.buttons):void 0})}))},addQueue:function(e,a){var i=new n(e,a);return o.push(i),t.resolve(i)},removeQueue:function(e){a.remove(o,e)}}}]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t["default"]=["_","MESSAGE_QUEUE_SCHEMES","ENTITY_TYPES","QUEUE_TYPES","Message","Helpers",function(e,t,o,i,s,r){"ngInject";var u=!0,l=function(){function l(a){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,l),"undefined"==typeof a&&(a=i.POST);var r={title:"Queue",_meta:{id:e.uniqueId(),parentId:void 0,type:o.QUEUE}};angular.extend(this,angular.copy(t[a]),r,s),u&&(this.isRoot=!0,u=!1),this.initialize()}return a(l,[{key:"initialize",value:function(){var t=this;if(e.get(this,"messages.length")){var n=angular.copy(this.messages);this.messages.length=0,e.each(n,function(e){t.addMessage(e.type,e)})}}},{key:"addMessage",value:function(e,t){var n=this,a=new s(e,t);return a._meta.parentId=this._meta.id,a.remove=function(){r.remove(n.messages,a)},this.messages.push(a),a}},{key:"removeMessage",value:function(e){return r.remove(this.messages,e)}}]),l}();return l}]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t["default"]=["_","$q","ENTITY_TYPES","MESSAGE_TYPES","MESSAGE_SCHEMES","MESSAGE_RESTRICTIONS","MessageActionButtonService","MessageActionButton","MessageImageItem","Helpers",function(e,t,o,i,s,r,u,l,c,d){"ngInject";var g=function(){function l(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,l),t||(t=i.TEXT),"undefined"!=typeof t&&t in s||(t=i.TEXT);var r={_meta:{id:e.uniqueId(),parentId:void 0,type:o.MESSAGE}};angular.extend(this,angular.copy(s[t]),r,a),this.initialize()}return a(l,[{key:"initialize",value:function(){var t=this;if(e.get(this,"buttons.length")){var n=angular.copy(this.buttons);this.buttons.length=0,e.each(n,function(e){t.addButton(e)})}if(e.get(this,"items.length")){var a=angular.copy(this.items);this.items.length=0,e.each(a,function(n){var a=t.addImage(n);if(e.get(a,"buttons.length")){var o=angular.copy(a.buttons);a.buttons.length=0,e.each(o,function(e){t.addButtonToImage(a,e)})}})}}},{key:"addButton",value:function(n){var a=this;return e.isArray(e.get(this,"buttons"))?this.buttons.length>=r.MAX_BUTTONS_COUNT?t.reject(null):u.add(n).then(function(e){return e._meta.parentId=a._meta.id,e.remove=function(){d.remove(a.buttons,e)},a.buttons.push(e),e}):t.reject(null)}},{key:"addImage",value:function(e){var t=this;if(this.items.length>=r.MAX_IMAGES_COUNT)return!1;var n=new c(e);return n._meta.parentId=this._meta.id,n.remove=function(){d.remove(t.items,n)},this.items.push(n),n}},{key:"addButtonToImage",value:function(n,a){var o=this;return e.isArray(e.get(n,"buttons"))?n.buttons.length>=r.MAX_BUTTONS_COUNT?t.reject(null):u.add(a).then(function(e){return e._meta.parentId=o._meta.id,e.remove=function(){d.remove(n.buttons,e)},n.buttons.push(e),e}):t.reject(null)}}]),l}();return g}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","$q","MessageActionButton","Helpers",function(e,t,n,a){"ngInject";var o=[];return{getAll:function(){var e=t.defer();return e.resolve(o),e.promise},getById:function(n){n+="";var a=e.find(o,{_meta:{id:n}}),i=t.defer();return i.resolve(a),i.promise},add:function(e){var a=t.defer(),i=new n(e);return o.push(i),a.resolve(i),a.promise},remove:function(e){a.remove(o,e)}}}]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t["default"]=["_","ENTITY_TYPES","MESSAGE_ACTION_TYPES","MESSAGE_BUTTON_SCHEME","$injector",function(e,t,o,i,s){"ngInject";var r=null,u=function(){function u(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,u);var s={title:"New Button",type:o.SEND_MESSAGE,_meta:{id:e.uniqueId(),parentId:void 0,type:t.BUTTON}};angular.extend(this,angular.copy(i),s,a),this.initialize()}return a(u,[{key:"initialize",value:function(){if(e.get(this,"messages.length")){var t=angular.copy(this.messages);this.messages.length=0,this.addMessages({messages:t})}}},{key:"addMessages",value:function(e){var t=this;return r||(r=s.get("BroadcastQueuesService")),r.addQueue(void 0,e).then(function(e){return e._meta.parentId=t._meta.id,t._meta.queueId=e._meta.id,t.messages=e.messages,e})}}]),u}();return u}]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","MESSAGE_GALLERY_ITEM_SCHEME","ENTITY_TYPES",function(e,t,a){"ngInject";var o=function i(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,i);var s={_meta:{id:e.uniqueId(),parentId:void 0,type:a.GALLERY_ITEM}};angular.extend(this,angular.copy(t),s,o)};return o}]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(104),i=a(o),s=n(105),r=a(s);t["default"]={template:i["default"],controller:r["default"],bindings:{values:"=",method:"="}}},function(e,t){var n,a=window.angular;try{n=a.module(["ng"])}catch(o){n=a.module("ng",[])}var i='<div class="btn rounded action-add" uib-popover-template="\'tpl/common/templates/valueSelect.html\'" popover-trigger="\'click outsideClick\'" popover-append-to-body="true" popover-is-open="$ctrl.isOpen" popover-class="list">\n</div>\n',s="tpl/BroadcastBuilder/addButton/addButton.tpl.html",r=a.element(window.document).injector();r?r.get("$templateCache").put(s,i):n.run(["$templateCache",function(e){e.put(s,i)}]),e.exports=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","MESSAGE_ACTION_TYPES","SCROLL_EVENT_NAME","$scope",function(e,t,n,a){"ngInject";var o=this;a.$on(n,function(){a.$applyAsync(function(){o.isOpen=!1})}),this.id=e.uniqueId(),this.MESSAGE_ACTION_TYPES=t,this.select=function(e){o.method(e)}}]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(107),i=a(o),s=n(108),r=a(s);t["default"]={template:i["default"],controller:r["default"],bindings:{button:"=",parentArray:"=array"}}},function(e,t){var n,a=window.angular;try{n=a.module(["ng"])}catch(o){n=a.module("ng",[])}var i='<button type="button" uib-popover-template="\'tpl/common/templates/actionButtonEdit.html\'" popover-trigger="\'click outsideClick\'" popover-append-to-body="true" popover-is-open="$ctrl.isEdit" class="btn btn-default btn-block">\n<div class="row">\n<span class="col-xs-10 col-xs-push-1">\n<div class="s-ellipsis">{{ $ctrl.button.title || \'Button\' }}</div>\n</span>\n<span class="col-xs-1">\n<span ng-class="{\'glyphicon glyphicon-share-alt\': $ctrl.button.messages.length}"></span>\n</span>\n</div>\n</button>\n',s="tpl/BroadcastBuilder/messageButton/messageButton.tpl.html",r=a.element(window.document).injector();
r?r.get("$templateCache").put(s,i):n.run(["$templateCache",function(e){e.put(s,i)}]),e.exports=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","$timeout","$state","MESSAGE_ACTION_TYPES","SCROLL_EVENT_NAME","$scope","Helpers",function(e,t,n,a,o,i,s){"ngInject";var r=this;i.$on(o,function(){i.$applyAsync(function(){r.isEdit=!1})}),this.id=e.uniqueId(),this.MESSAGE_ACTION_TYPES=a,this.removeButton=function(e){s.remove(r.parentArray,e)},this.saveButton=function(){r.isEdit=!1},this.editMessages=function(e){console.warn("editQueue",e),e._meta.queueId?n.go("broadcast.child",{id:e._meta.queueId},{location:!1}):r.button.addMessages().then(function(e){n.go("broadcast.child",{id:e._meta.id},{location:!1})})},this.button._isEdit&&t(function(){r.isEdit=!0,delete r.button._isEdit})}]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(110),i=a(o),s=n(111),r=a(s);t["default"]={template:i["default"],controller:r["default"],controllerAs:"vm",bindings:{messagesQueue:"=queue"}}},function(e,t){var n,a=window.angular;try{n=a.module(["ng"])}catch(o){n=a.module("ng",[])}var i='<div class="builder">\n<div class="builder-inner l-pb-20">\n<div ng-sortable="vm.sortableConfig">\n<div ng-repeat="message in vm.messages" message-item>\n<message-text ng-if="message.type === vm.MESSAGE_TYPES.TEXT" message="message">\n</message-text>\n<message-image ng-if="message.type === vm.MESSAGE_TYPES.IMAGE" message="message">\n</message-image>\n<message-gallery ng-if="message.type === vm.MESSAGE_TYPES.GALLERY" message="message" config="vm.sortableConfig">\n</message-gallery>\n</div>\n</div>\n<div class="add-message-button">\n<add-button values="vm.messageTypesForSelect" method="vm.onMessageTypeSelect">\n</add-button>\n</div>\n</div>\n</div>\n<div class="builder-controls l-plr-40 l-ptb-0">\n<button class="btn btn-default l-mr-25">Preview</button>\n<button class="btn btn-success" ng-click="vm.startBroadcast()">Start broadcast</button>\n</div>\n<pre ng-if="vm.__DEBUG__">{{vm.queues | json}}</pre>\n',s="tpl/app/BroadcastBuilder/broadcastBuilder.tpl.html",r=a.element(window.document).injector();r?r.get("$templateCache").put(s,i):n.run(["$templateCache",function(e){e.put(s,i)}]),e.exports=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","$timeout","__DEBUG__","MESSAGE_TYPES","SCROLL_EVENT_NAME","SortableConfig","BroadcastQueuesService","$element","$scope",function(e,t,n,a,o,i,s,r,u){"ngInject";var l=this;l.__DEBUG__=n,l.id=e.uniqueId(),l.MESSAGE_TYPES=a,l.messagesQueue||console.warn("broadcastBuilder.ctrl needs an messagesQueue"),l.messages=l.messagesQueue.messages,l.messageTypesForSelect=[{value:a.TEXT,title:"Add text card"},{value:a.IMAGE,title:"Add image card"},{value:a.GALLERY,title:"Add gallery"}],l.sortableConfig=new i,l.addMessage=function(){var e;return!!l.messagesQueue&&void(e=l.messagesQueue).addMessage.apply(e,arguments)},l.onMessageTypeSelect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l.addMessage(e.value)},l.startBroadcast=function(){l.serializeData().then(function(e){console.warn("MESSAGES:",e)})},l.parseData=function(){},l.serializeData=function(){function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.each(t,function(e){delete e._meta,n(e.messages)}),t}function n(n){return e.chain(n).each(function(n){delete n._meta,t(e.get(n,"buttons",[])),e.each(e.get(n,"items",[]),function(n){delete n._meta,t(e.get(n,"buttons",[]))})}).value()}return s.getRoot().then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=angular.copy(e),angular.toJson(n(e.messages||[]),!0)})};var c=angular.element(r[0].querySelector(".builder-inner"));return c.on("scroll",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];u.$broadcast.apply(u,[o].concat(t))}),n&&s.getAll().then(function(e){l.queues=e}),l}]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(113),i=a(o),s=n(116),r=a(s);t["default"]={template:i["default"],controller:r["default"],controllerAs:"vm",bindings:{message:"="}}},function(e,t,n){var a,o=window.angular;try{a=o.module(["ng"])}catch(i){a=o.module("ng",[])}var s='<div class="post card card-text">\n<div class="card-inner">\n<div class="action-drag-move">\n<img src="'+n(114)+'" alt="">\n</div>\n<div class="action-remove" ng-click="vm.removeMessage()">\n<img src="'+n(115)+'" alt="">\n</div>\n<div class="l-p-15">\n<div class="l-relative">\n<textarea elastic rows="1" ng-model="vm.message.text" max-length="320" name="text" class="form-control" placeholder="Add Text" required>\n\t\t\t\t</textarea>\n</div>\n</div>\n<div ng-repeat="button in vm.message.buttons">\n<message-button button="button" array="vm.message.buttons">\n</message-button>\n</div>\n<button type="button" ng-click="vm.addButton()" ng-if="vm.message.buttons.length < vm.MAX_BUTTONS_COUNT" class="btn btn-default btn-block ctrl add-btn s-brt-1">+ Add new button\n</button>\n</div>\n</div>\n',r="tpl/messages/text/messageText.tpl.html",u=o.element(window.document).injector();u?u.get("$templateCache").put(r,s):a.run(["$templateCache",function(e){e.put(r,s)}]),e.exports=s},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjhweCIgaGVpZ2h0PSIyMnB4IiB2aWV3Qm94PSIwIDAgOCAyMiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNDAuMSAoMzM4MDQpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPgogICAgPHRpdGxlPmljb25fbW92ZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJCcm9hZGNhc3QtbGluZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTU3LjAwMDAwMCwgLTE0OC4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9IkNvbnRlbnQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMzQuMDAwMDAwLCAxMDQuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iaWNvbl9tb3ZlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyOTEuMDAwMDAwLCA0NC4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iU2hhcGUiIGZpbGw9IiM5OTk5OTkiIHBvaW50cz0iMyA5IDMgNCAxLjUgNS41IDAuMDggNC4wOCA0IDAuMTYgNy45MiA0LjA4IDYuNSA1LjUgNSA0IDUgOSI+PC9wb2x5Z29uPgogICAgICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iIzk5OTk5OSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC4wMDAwMDAsIDE3LjU4MDAwMCkgcm90YXRlKDE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC4wMDAwMDAsIC0xNy41ODAwMDApICIgcG9pbnRzPSIzIDIyIDMgMTcgMS41IDE4LjUgMC4wOCAxNy4wOCA0IDEzLjE2IDcuOTIgMTcuMDggNi41IDE4LjUgNSAxNyA1IDIyIj48L3BvbHlnb24+CiAgICAgICAgICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC0zIiBzdHJva2U9IiM5OTk5OTkiIHN0cm9rZS13aWR0aD0iMiIgZmlsbD0iI0YyRjRGNSIgY3g9IjQiIGN5PSIxMSIgcj0iMiI+PC9jaXJjbGU+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjE0cHgiIGhlaWdodD0iMThweCIgdmlld0JveD0iMCAwIDE0IDE4IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0MC4xICgzMzgwNCkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+aWNvbl9kZWxldGU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iQnJvYWRjYXN0LWxpbmUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zODYuMDAwMDAwLCAtMTQ5LjAwMDAwMCkiIGZpbGw9IiM5OTk5OTkiPgogICAgICAgICAgICA8ZyBpZD0iQ29udGVudCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIzNC4wMDAwMDAsIDEwNC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJUZXh0LUNhcmQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI4My4wMDAwMDAsIDMzLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJpY29uX2RlbGV0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzM3LjAwMDAwMCwgMTIuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNCwxIEwxMC41LDEgTDkuNSwwIEw0LjUsMCBMMy41LDEgTDAsMSBMMCwzIEwxNCwzIEwxNCwxIFogTTEsMTYgQzEsMTcuMTA0NTY5NSAxLjg5NTQzMDUsMTggMywxOCBMMTEsMTggQzEyLjEwNDU2OTUsMTggMTMsMTcuMTA0NTY5NSAxMywxNiBMMTMsNCBMMSw0IEwxLDE2IEwxLDE2IFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","$timeout","MESSAGE_TYPES","MESSAGE_RESTRICTIONS",function(e,t,n,a){"ngInject";this.MAX_BUTTONS_COUNT=a.MAX_BUTTONS_COUNT;var o=this.message;this.id=e.uniqueId(),this.removeMessage=function(){o.remove()},this.addButton=function(){o.addButton().then(function(e){e._isEdit=!0})}}]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(118),i=a(o),s=n(119),r=a(s);t["default"]={template:i["default"],controller:r["default"],controllerAs:"vm",bindings:{message:"="}}},function(e,t,n){var a,o=window.angular;try{a=o.module(["ng"])}catch(i){a=o.module("ng",[])}var s='<div class="post card card-image">\n<div class="card-inner">\n<div class="action-drag-move">\n<img src="'+n(114)+'" alt="">\n</div>\n<div class="action-remove" ng-click="vm.removeMessage()">\n<img src="'+n(115)+'" alt="">\n</div>\n<div class="dropzone s-bg-contains" ng-style="{\'background-image\':\'url(\'+vm.message.img+\')\'}">\n<label for="{{:: vm.id }}" class="upload-block text-center">\n<span ng-if="!vm.message.img">\n<i class="glyphicon glyphicon-camera"></i>\nUpload image\n</span>\n</label>\n<div class="l-relative">\n<input id="{{:: vm.id }}" name="file-{{:: vm.id }}" type="file" ng-maxlength="80" fileread="vm.message.img" ng-model="vm.files" file-change="vm.onFileChange($event, files, vm.message)">\n</div>\n</div>\n</div>\n</div>\n',r="tpl/messages/image/messageImage.tpl.html",u=o.element(window.document).injector();u?u.get("$templateCache").put(r,s):a.run(["$templateCache",function(e){e.put(r,s)}]),e.exports=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","Api",function(e,t){"ngInject";var n=this,a=n.message,o="img";return n.id=e.uniqueId(),n.removeMessage=function(){a.remove()},n.onFileChange=function(e,n,a){console.warn("image filechange",e,a),t.upload(n[0]).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.path;t&&(a[o]=t)})["catch"](function(e){console.warn("upload error",e)})},n}]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(121),i=a(o),s=n(122),r=a(s);t["default"]={template:i["default"],controller:r["default"],controllerAs:"vm",bindings:{message:"="}}},function(e,t,n){var a,o=window.angular;try{a=o.module(["ng"])}catch(i){a=o.module("ng",[])}var s='<div class="post card card-gallery">\n<div class="card-inner">\n<div class="action-drag-move">\n<img src="'+n(114)+'" alt="">\n</div>\n<div class="action-remove" ng-click="vm.removeMessage()">\n<img src="'+n(115)+'" alt="">\n</div>\n<div class="l-relative no-wrap">\n<div class="images-list no-wrap" ng-sortable="vm.sortableConfig">\n<div ng-repeat="image in vm.message.items" class="card-gallery-image">\n<div class="card-gallery-image-inner">\n<div class="action-drag-move">\n<img src="'+n(114)+'" alt="">\n</div>\n<div class="action-remove" ng-click="vm.removeImage(image)">\n<img src="'+n(115)+'" alt="">\n</div>\n<div class="dropzone s-bg-contains" ng-style="{\'background-image\':\'url(\'+image.img+\')\'}">\n<label for="{{:: vm.id + $index }}" class="upload-block text-center">\n<span ng-if="!image.img">\n<i class="glyphicon glyphicon-camera"></i>Upload\n</span>\n</label>\n<input id="{{:: vm.id + $index }}" name="file-{{:: vm.id + $index }}" type="file" fileread="image.img" ng-model="vm.files" file-change="vm.onFileChange($event, files, image)">\n</div>\n<div class="l-plr-15 l-ptb-5">\n<div class="l-relative">\n<input ng-model="image.title" max-length="80" type="text" name="title" class="form-control" placeholder="Heading">\n</div>\n<div class="l-relative">\n<textarea elastic rows="1" ng-model="image.text" max-length="80" class="form-control" placeholder="Description">\n\t\t\t\t\t\t\t\t</textarea>\n</div>\n<input ng-model="image.url" type="text" name="url" class="form-control" placeholder="URL">\n</div>\n<div ng-repeat="button in image.buttons">\n<message-button button="button" array="image.buttons">\n</message-button>\n</div>\n<button type="button" ng-click="vm.addButton(image)" ng-if="image.buttons.length < vm.MAX_BUTTONS_COUNT" class="btn btn-default btn-block ctrl add-btn s-brt-1">+ Add new button\n</button>\n</div>\n</div>\n</div>\n<div ng-click="vm.addImage()" ng-if="vm.message.items.length < vm.MAX_IMAGES_COUNT" class="card-gallery-add-image s-cp">\n</div>\n</div>\n</div>\n</div>\n',r="tpl/messages/gallery/messageGallery.tpl.html",u=o.element(window.document).injector();u?u.get("$templateCache").put(r,s):a.run(["$templateCache",function(e){e.put(r,s)}]),e.exports=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_","MESSAGE_TYPES","MESSAGE_RESTRICTIONS","Api","Message","MessageImageItem","MessageActionButton","SortableConfig",function(e,t,n,a,o,i,s,r){"ngInject";var u="img",l=this;return!!e.isArray(e.get(l,"message.items"))&&(l.MAX_BUTTONS_COUNT=n.MAX_BUTTONS_COUNT,l.MAX_IMAGES_COUNT=n.MAX_IMAGES_COUNT,l.id=e.uniqueId(),l.sortableConfig=new r,l.removeMessage=function(){l.message.remove()},l.addButton=function(e){l.message.addButtonToImage(e).then(function(e){e._isEdit=!0})},l.addImage=function(){l.message.addImage()},l.removeImage=function(t){t.remove(),e.get(l,"message.items.length")<1&&l.removeMessage()},l.files=[],l.onFileChange=function(e,t,n){console.warn("gallery filechange",e,n),a.upload(t[0]).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.path;t&&(n[u]=t)})["catch"](function(e){console.warn("upload error",e)})},e.get(l,"message.items.length")||l.addImage(),l)}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["$stateProvider",function(e){"ngInject";e.state("broadcast",{"abstract":!0,resolve:{queues:["BroadcastQueuesService",function(e){return e.getAll()}]},onEnter:["$stateParams",function(e){return console.warn("state broadcast",e),{}}],template:'\n\t\t\t<broadcast-builder-breadcrumbs model="$resolve.queues"></broadcast-builder-breadcrumbs>\n\t\t\t<ui-view></ui-view>\n\t\t'}),e.state("broadcast.child",{url:"/*id",params:{id:{value:void 0,squash:!0}},resolve:{messagesQueue:["$stateParams","$state","$q","QUEUE_TYPES","BroadcastQueuesService",function(e,t,n,a,o){var i=n.defer(),s=e.id,r={};return window.BROADCAST_MESSAGES&&(console.warn("BROADCAST_MESSAGES !!",window.BROADCAST_MESSAGES),r.messages=angular.copy(window.BROADCAST_MESSAGES),delete window.BROADCAST_MESSAGES),s?o.getById(s).then(function(e){i.resolve(e?e:o.addQueue(a.POST,r))}):i.resolve(o.addQueue(a.POST,r)),i.promise}]},onEnter:["$stateParams",function(e){return console.warn("state broadcast.child",e),{}}],template:'<broadcast-builder queue="$resolve.messagesQueue"></broadcast-builder>',controllerAs:"vm"})}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["_",function(e){"ngInject";function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return angular.merge({group:{name:e.uniqueId(),pull:!1,put:!1},handle:".action-drag-move",animation:250,forceFallback:!0,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag"},t)}return t}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){return{remove:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=e.indexOf(t);return n!==-1&&e.splice(n,1)},uniqueId:function(){this.uniqueId.ids||(this.uniqueId.ids={});var e;do e=Math.floor(Date.now()*Math.random());while(this.uniqueId.ids[e]);return this.uniqueId.ids[e]=e,e}}}}]);
//# sourceMappingURL=main-e74e0c10df70007d63ab.js.map